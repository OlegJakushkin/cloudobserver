<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    
    <head>
        <title>
            Cloud Observer
        </title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<script type="text/javascript">
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-21524436-1']);
			_gaq.push(['_setDomainName', 'none']);
			_gaq.push(['_setAllowLinker', true]);
			_gaq.push(['_trackPageview']);
			
			(function () {
			    var ga = document.createElement('script');
			    ga.type = 'text/javascript';
			    ga.async = true;
			    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			    var s = document.getElementsByTagName('script')[0];
			    s.parentNode.insertBefore(ga, s);
			})();
			_gaq.push(['_setCustomVar', 1, // This custom var is set to slot #1
			'URL', // The name acts as a kind of category for the user activity
			window.location.toString(), // This value of the custom variable
			1]);
			_gaq.push(['_trackEvent', 'Visit on page', // category of activity
			window.location.toString() // Action
			]);
		</script>
        <style type="text/css">
			body
			{
			  background-color:#FFF;
			  font:100.01% "Trebuchet MS",Verdana,Arial,sans-serif;
			}
						
			h1,h2,p
			{
			  margin:0 10px;
			}
			
			h1
			{
			  font-size:250%;
			  color:#FFF;
			  text-shadow:0 1px 1px #000;
			}
			
			h2
			{
			  font-size:200%;
			  color:#f0f0f0;
			  padding-top:.3em;
			}
			a#rol
			{ 
				color: #FFF; text-shadow:0px 1px 1px #000;
			} 
			div#nifty
			{
			  background:#9BD1FA;
			  margin:0 10%;
			}
			
			b.rtop,b.rbottom
			{
			  display:block;
			  background:#FFF;
			}
			
			b.rtop b,b.rbottom b
			{
			  display:block;
			  height:1px;
			  overflow:hidden;
			  background:#9BD1FA;
			}
			
			b.r1
			{
			  margin:0 5px;
			}
			
			b.r2
			{
			  margin:0 3px;
			}
			
			b.r3
			{
			  margin:0 2px;
			}
			
			b.rtop b.r4,b.rbottom b.r4
			{
			  height:2px;
			  margin:0 1px;
			}
			
			p
			{
			  color:#000;
			  text-shadow:0 1px 1px #fff;
			  padding-bottom:1em;
			}
			hr
			{
				color: rgba(0, 0, 0, 0.1); height: 0.5px; background-color:rgba(0, 0, 0, 0.1);
			} 
			input[type="button"],.eButton
			{
			  width:150px;
			  word-wrap:break-word;
			  height:auto;
			  padding:5px 10px;
			}
        </style>
    </head>
    <body onresize="resized()">
        <script>
            function $(id) {
                return document.getElementById(id);
            }

            function getOffset(el) {
                var _x = 0;
                var _y = 0;
                while (el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)) {
                    _x += el.offsetLeft - el.scrollLeft;
                    _y += el.offsetTop - el.scrollTop;
                    el = el.parentNode;
                }
                return {
                    top: _y,
                    left: _x
                };
            }

            var exNames = [];
            var wins = [];
            var w = 0;
            var h = 0;
            var maxHeight = 0;
            var firstRun = 0;


 run = function(name, width, height) {

                var winsJoin = "|" + exNames.join("|") + "|";
                var closedWins = [];
                for (var i = 0; i < wins.length; ++i) {
                    if (wins[i].closed) {
                        closedWins.push(exNames[i]);
                    }
                }
                var closedJoin = "|" + closedWins.join("|") + "|";
                if (winsJoin.indexOf('|' + name + '|') == -1 || closedJoin.indexOf('|' + name + '|') != -1) {
                    if (height > maxHeight) {
                        maxHeight = height + 55;
                    }
                    if (window.screenX + getOffset(document.getElementById('usersList')).left >= screen.width / 2) {
                        if (window.screenX + 102 - w - width < 0) {
                            w = 0;
                            h = h + maxHeight;
                            top = h + 1;
                            maxHeight = 0;
                            if (screen.height - h - height + getOffset(document.getElementById('usersList')).left - 155 < 0) {
                                h = 0;
                            }
                        }
                    }
                    if (window.screenX + getOffset(document.getElementById('usersList')).left < screen.width / 2) {
                        if (firstRun == 0) {
                            w = window.screenX + getOffset(document.getElementById('usersList')).left + 150;
                            firstRun = 1;
                        }
                        if (screen.width - w - width < 0) {
                            w = window.screenX + +getOffset(document.getElementById('usersList')).left + 150;
                            h = h + maxHeight;
                            top = h + 1;
                            maxHeight = 0;
                            if (screen.height - h - height < 0) {
                                h = 0;
                            }
                        }
                    }
                    left = w + 1;
                    tops = h + 1;
                    w = w + width + 7;
                    var file = './' + name;
                    var settings = 'width=' + width + ', height=' + height + ', left=' + left + ', top=' + tops + ', screenX=' + left + ', screenY=' + tops;
                    wins.push(window.open(file, name, settings));
                    exNames.push(name);
                }
                for (var i = 0; i < wins.length; ++i) {
                    wins[i].focus();
                }
            }



            openWin = function(name, width, height) {

                var winsJoin = "|" + exNames.join("|") + "|";
                var closedWins = [];
                for (var i = 0; i < wins.length; ++i) {
                    if (wins[i].closed) {
                        closedWins.push(exNames[i]);
                    }
                }
                var closedJoin = "|" + closedWins.join("|") + "|";
                if (winsJoin.indexOf('|' + name + '|') == -1 || closedJoin.indexOf('|' + name + '|') != -1) {
                    if (height > maxHeight) {
                        maxHeight = height + 55;
                    }
                    if (window.screenX + getOffset(document.getElementById('usersList')).left >= screen.width / 2) {
                        if (window.screenX + 102 - w - width < 0) {
                            w = 0;
                            h = h + maxHeight;
                            top = h + 1;
                            maxHeight = 0;
                            if (screen.height - h - height + getOffset(document.getElementById('usersList')).left - 155 < 0) {
                                h = 0;
                            }
                        }
                    }
                    if (window.screenX + getOffset(document.getElementById('usersList')).left < screen.width / 2) {
                        if (firstRun == 0) {
                            w = window.screenX + getOffset(document.getElementById('usersList')).left + 150;
                            firstRun = 1;
                        }
                        if (screen.width - w - width < 0) {
                            w = window.screenX + +getOffset(document.getElementById('usersList')).left + 150;
                            h = h + maxHeight;
                            top = h + 1;
                            maxHeight = 0;
                            if (screen.height - h - height < 0) {
                                h = 0;
                            }
                        }
                    }
                    left = w + 1;
                    tops = h + 1;
                    w = w + width + 7;
                    var file = './' + name + '.flv?action=play';
                    var settings = 'width=' + width + ', height=' + height + ', left=' + left + ', top=' + tops + ', screenX=' + left + ', screenY=' + tops;
                    wins.push(window.open(file, name, settings));
                    exNames.push(name);
                }
                for (var i = 0; i < wins.length; ++i) {
                    wins[i].focus();
                }
            }

            function update() {
                var xmlhttp;
                try {
                    xmlhttp = new XMLHttpRequest();
                } catch (e) {
                    var success = false;
                    var objects = ["MSXML2.XMLHTTP.5.0", "MSXML2.XMLHTTP.4.0", "MSXML2.XMLHTTP.3.0", "MSXML2.XMLHTTP", "Microsoft.XMLHTTP"];
                    for (var i = 0; i < objects.length && !success; i++) {
                        try {
                            xmlhttp = new ActiveXObject(objects[i]);
                            success = true;
                        } catch (e) {};
                    }
                    if (!success) throw new Error("AJAX is unavailabe");
                }
                xmlhttp.onreadystatechange = function() {
                    if (xmlhttp.readyState == 4) {
                        if (document.getElementById('usersList').innerHTML != xmlhttp.responseText) document.getElementById('usersList').innerHTML = xmlhttp.responseText;
                    };
                }
                xmlhttp.open("get", "buttons.html", true);
                xmlhttp.send(null);
            }
            update();
            setInterval(update, 5000);
        </script>
        <div id="container">
        </div>
        <div id="info">
            <p/>
            <div id="nifty">
                <b class="rtop">
                    <b class="r1">
                    </b>
                    <b class="r2">
                    </b>
                    <b class="r3">
                    </b>
                    <b class="r4">
                    </b>
                </b>
                <h1>
                    <img src="logo.png" alt="Cloud Observer" border="0" usemap="#Map2" >
                    <map name="Map2">
                      <area shape="rect" coords="0,0,400,100" href="index.html" alt="Cloud Observer Main Page">
                    </map>
					</img>
                </h1>
                <b class="rbottom">
                    <b class="r4">
                    </b>
                    <b class="r3">
                    </b>
                    <b class="r2">
                    </b>
                    <b class="r1">
                    </b>
                </b>
            </div>
            <p/>
            <div id="nifty">
                <b class="rtop">
                    <b class="r1">
                    </b>
                    <b class="r2">
                    </b>
                    <b class="r3">
                    </b>
                    <b class="r4">
                    </b>
                </b>
                <h1>
                    Online users 
                </h1>
                <p>
                    You can watch user streams by clicking on buttons with their names.
                </p>
                <hr>
                <ul id="usersList">
                 	_ONLINE_USERS_
                </ul>
                <hr>

<p>

 <p><a     href="#" id="rol" onClick="run('downloads.html', 750, 500);"  >Download</a>   our app and start broadcasting now on <a href="#WindowsDownload" id="rol" >Windows</a>,  <a href="#LinuxDownload" id="rol" >Linux</a> or <a href="#MacOSXDownload" id="rol" >Mac OS X</a>!</p>

<p style="font-size: 8pt">
    Copyright &copy 2011 <a style=" color: #FFF;" id="rol" href="#cloudobserver" onClick="{	newwindow=window.open('http://code.google.com/p/cloudobserver/','CloudObserver','height=750,width=900');	if (window.focus) {newwindow.focus()}}">Cloud Forever</a>. All rights reserved. </p>

                <b class="rbottom">
                    <b class="r4">
                    </b>
                    <b class="r3">
                    </b>
                    <b class="r2">
                    </b>
                    <b class="r1">
                    </b>
                </b>
            </div>

    </div>
        <script type="text/javascript" src="./js/Three.js">
        </script>
        <script type="text/javascript" src="./js/Cube.js">
        </script>
        <script type="text/javascript">
            var BrowserDetect = {
                init: function() {
                    this.browser = this.searchString(this.dataBrowser) || "An unknown browser";
                    this.version = this.searchVersion(navigator.userAgent) || this.searchVersion(navigator.appVersion) || "an unknown version";
                    this.OS = this.searchString(this.dataOS) || "an unknown OS";
                },
                searchString: function(data) {
                    for (var i = 0; i < data.length; i++) {
                        var dataString = data[i].string;
                        var dataProp = data[i].prop;
                        this.versionSearchString = data[i].versionSearch || data[i].identity;
                        if (dataString) {
                            if (dataString.indexOf(data[i].subString) != -1) return data[i].identity;
                        } else if (dataProp) return data[i].identity;
                    }
                },
                searchVersion: function(dataString) {
                    var index = dataString.indexOf(this.versionSearchString);
                    if (index == -1) return;
                    return parseFloat(dataString.substring(index + this.versionSearchString.length + 1));
                },
                dataBrowser: [{
                    string: navigator.userAgent,
                    subString: "Chrome",
                    identity: "Chrome"
                },
                {
                    string: navigator.userAgent,
                    subString: "OmniWeb",
                    versionSearch: "OmniWeb/",
                    identity: "OmniWeb"
                },
                {
                    string: navigator.vendor,
                    subString: "Apple",
                    identity: "Safari",
                    versionSearch: "Version"
                },
                {
                    prop: window.opera,
                    identity: "Opera"
                },
                {
                    string: navigator.vendor,
                    subString: "iCab",
                    identity: "iCab"
                },
                {
                    string: navigator.vendor,
                    subString: "KDE",
                    identity: "Konqueror"
                },
                {
                    string: navigator.userAgent,
                    subString: "Firefox",
                    identity: "Firefox"
                },
                {
                    string: navigator.vendor,
                    subString: "Camino",
                    identity: "Camino"
                },
                { // for newer Netscapes (6+)
                    string: navigator.userAgent,
                    subString: "Netscape",
                    identity: "Netscape"
                },
                {
                    string: navigator.userAgent,
                    subString: "MSIE",
                    identity: "Explorer",
                    versionSearch: "MSIE"
                },
                {
                    string: navigator.userAgent,
                    subString: "Gecko",
                    identity: "Mozilla",
                    versionSearch: "rv"
                },
                { // for older Netscapes (4-)
                    string: navigator.userAgent,
                    subString: "Mozilla",
                    identity: "Netscape",
                    versionSearch: "Mozilla"
                }],
                dataOS: [{
                    string: navigator.platform,
                    subString: "Win",
                    identity: "Windows"
                },
                {
                    string: navigator.platform,
                    subString: "Mac",
                    identity: "Mac"
                },
                {
                    string: navigator.userAgent,
                    subString: "iPhone",
                    identity: "iPhone/iPod"
                },
                {
                    string: navigator.platform,
                    subString: "Linux",
                    identity: "Linux"
                }]

            };
            BrowserDetect.init();

            //document.write('<p>' + BrowserDetect.browser + '</p>');
            //document.write('<p>' + BrowserDetect.version + '</p>');
            var camera, scene, renderer;

            var fov = 70,
                texture_placeholder, isUserInteracting = false,
                onMouseDownMouseX = 0,
                onMouseDownMouseY = 0,
                lon = 90,
                onMouseDownLon = 0,
                lat = 0,
                onMouseDownLat = 0,
                phi = 0,
                theta = 0,
                html5support = 0;

            if (((BrowserDetect.browser == "Chrome") && (BrowserDetect.version >= 8)) || ((BrowserDetect.browser == "Explorer") && (BrowserDetect.version >= 9)) ||  ((BrowserDetect.browser == "Opera") && (BrowserDetect.version >= 10)) || ((BrowserDetect.browser == "Firefox") && (BrowserDetect.version >= 4))) {
                html5support = 1; //  document.write('<p>' + '3d three js, Html 5 Capable' + '</p>');
                document.write('  <style type="text/css">  body { background-color: rgb(200,200,200); margin: 0px; overflow: hidden; font: 100.01% "Trebuchet MS",Verdana,Arial,sans-serif; } #info { position: absolute; top: 0px; width: 100%; color: #ffffff; padding: 5px; font-family:Monospace;font-size:13px; font-weight: bold; } a { color: #ffffff;} h1,h2,p{margin: 0 10px} h1{font-size: 250%;color: #FFF; text-shadow:0px 1px 1px #000;} h2{font-size: 200%;color: #f0f0f0;padding-top: 0.3em}div#nifty{ margin: 0 10%;background: rgba(250, 250, 250, 0.1); -moz-border-radius:15px; border-radius: 15px;} b.rtop, b.rbottom{display:block;background:#FFF; } b.rtop b, b.rbottom b{display:block;height: 1px;overflow: hidden; background: #9BD1FA} b.r1{margin: 0 5px} b.r2{margin: 0 3px} b.r3{margin:0 2px} b.rtop b.r4, b.rbottom b.r4{margin: 0 1px;height: 2px} p, ul{color:#000;text-shadow: 0px 1px 1px rgba(255,255,255,0.6);padding-bottom:1em}input[type="button"], .eButton {width: 150px;padding: 5px 10px;word-wrap:break-word;height: auto;} b.rtop, b.rbottom{display:none;background: rgba(0,0,0,0)}html{ width:100%; height:100%; } body{ width:100%; height:100%; }  #container{ width:100%; height:100%;} </style>');
                init();
                render();
            }

            function init() {

                var container, mesh;

                container = document.getElementById('container');

                camera = new THREE.Camera(fov, window.innerWidth / window.innerHeight, 1, 1100);
                camera

                scene = new THREE.Scene();

                texture_placeholder = document.createElement('canvas');
                texture_placeholder.width = 128;
                texture_placeholder.height = 128;

                var context = texture_placeholder.getContext('2d');
                context.fillStyle = 'rgb( 200, 200, 200 )';
                context.fillRect(0, 0, texture_placeholder.width, texture_placeholder.height);

                var materials = [

                loadTexture('textures/cube/skybox/px.jpg'), // right
                loadTexture('textures/cube/skybox/nx.jpg'), // left
                loadTexture('textures/cube/skybox/py.jpg'), // top
                loadTexture('textures/cube/skybox/ny.jpg'), // bottom
                loadTexture('textures/cube/skybox/pz.jpg'), // back
                loadTexture('textures/cube/skybox/nz.jpg') // front
                ];

                mesh = new THREE.Mesh(new Cube(300, 300, 300, 7, 7, materials, true), new THREE.MeshFaceMaterial());
                mesh.overdraw = true;
                scene.addObject(mesh);

                renderer = new THREE.CanvasRenderer();
                renderer.setSize(window.innerWidth, window.innerHeight);

                container.appendChild(renderer.domElement);

                document.addEventListener('mousedown', onDocumentMouseDown, false);
                document.addEventListener('mousemove', onDocumentMouseMove, false);
                document.addEventListener('mouseup', onDocumentMouseUp, false);
                document.addEventListener('mousewheel', onDocumentMouseWheel, false);

                document.addEventListener('touchstart', onDocumentTouchStart, false);
                document.addEventListener('touchmove', onDocumentTouchMove, false);

            }

            function loadTexture(path) {

                var material = new THREE.MeshBasicMaterial({
                    map: new THREE.Texture(texture_placeholder)
                });

                var image = new Image();

                image.onload = function() {

                    this.loaded = true;
                    material.map.image = this;
                    render();

                };

                image.src = path;

                return material;
            }





            function onDocumentMouseDown(event) {

                event.preventDefault();

                isUserInteracting = true;

                onPointerDownPointerX = event.clientX;
                onPointerDownPointerY = event.clientY;

                onPointerDownLon = lon;
                onPointerDownLat = lat;

            }

            function onDocumentMouseMove(event) {

                if (isUserInteracting) {

                    lon = (onPointerDownPointerX - event.clientX) * 0.1 + onPointerDownLon;
                    lat = (event.clientY - onPointerDownPointerY) * 0.1 + onPointerDownLat;

                    render();

                }
            }

            function onDocumentMouseUp(event) {

                isUserInteracting = false;
                render();

            }

            function onDocumentMouseWheel(event) {

                //    	fov -= event.wheelDeltaY * 0.05;
                //   	camera.projectionMatrix = THREE.Matrix4.makePerspective( fov, window.innerWidth / window.innerHeight, 1, 1100 );
                //	render();
            }


            function onDocumentTouchStart(event) {

                if (event.touches.length == 1) {

                    event.preventDefault();

                    onPointerDownPointerX = event.touches[0].pageX;
                    onPointerDownPointerY = event.touches[0].pageY;

                    onPointerDownLon = lon;
                    onPointerDownLat = lat;
                }
            }

            function onDocumentTouchMove(event) {

                if (event.touches.length == 1) {

                    event.preventDefault();

                    lon = (onPointerDownPointerX - event.touches[0].pageX) * 0.1 + onPointerDownLon;
                    lat = (event.touches[0].pageY - onPointerDownPointerY) * 0.1 + onPointerDownLat;

                    render();

                }
            }

            function render() {

                lat = Math.max(-85, Math.min(85, lat));
                phi = (90 - lat) * Math.PI / 180;
                theta = lon * Math.PI / 180;

                camera.target.position.x = 500 * Math.sin(phi) * Math.cos(theta);
                camera.target.position.y = 500 * Math.cos(phi);
                camera.target.position.z = 500 * Math.sin(phi) * Math.sin(theta);

                renderer.render(scene, camera);

            }

            function resized() {

                if (html5support == 1) if (((document.body.clientWidth / document.body.clientHeight) < 6) && ((document.body.clientWidth / document.body.clientHeight) > (1 / 6))) {
                    $('container').width = document.body.clientWidth;
                    $('container').height = document.body.clientHeight;
                    $('container').innerHTML = "";
                    init();
                    render();
                }

            }
        </script>
    </body>

</html>