<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Cloud Observer</title>
<style type="text/css">body{padding: 20px;background-color: #FFF;font: 100.01% "Trebuchet MS",Verdana,Arial,sans-serif}
h1,h2,p{margin: 0 10px}
h1{font-size: 250%;color: #FFF; text-shadow: 0px 1px 1px #000;}
h2{font-size: 200%;color: #f0f0f0;padding-top: 0.3em}
div#nifty{ margin: 0 10%;background: #9BD1FA}
b.rtop, b.rbottom{display:block;background: #FFF}
b.rtop b, b.rbottom b{display:block;height: 1px;overflow: hidden; background: #9BD1FA}
b.r1{margin: 0 5px}
b.r2{margin: 0 3px}
b.r3{margin: 0 2px}
b.rtop b.r4, b.rbottom b.r4{margin: 0 1px;height: 2px}
p{color: #000;text-shadow: 0px 1px 1px #fff;padding-bottom:1em}
input[type="button"], .eButton {width: 150px;padding: 5px 10px;word-wrap: break-word;height: auto;}
</style>
</head> <body>
<script>
    function getOffset(el) {
        var _x = 0;
        var _y = 0;
        while (el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)) {
            _x += el.offsetLeft - el.scrollLeft;
            _y += el.offsetTop - el.scrollTop;
            el = el.parentNode;
        }
        return {
            top: _y,
            left: _x
        };
    }

    var exNames = [];
    var wins = [];
    var w = 0;
    var h = 0;
    var maxHeight = 0;
    var firstRun = 0;

    openWin = function(name, width, height) {

        var winsJoin = "|" + exNames.join("|") + "|";
        var closedWins = [];
        for (var i = 0; i < wins.length; ++i) {
            if (wins[i].closed) {
                closedWins.push(exNames[i]);
            }
        }
        var closedJoin = "|" + closedWins.join("|") + "|";
        if (winsJoin.indexOf('|' + name + '|') == -1 || closedJoin.indexOf('|' + name + '|') != -1) {
            if (height > maxHeight) {
                maxHeight = height + 55;
            }
            if (window.screenX + getOffset(document.getElementById('usersList')).left >= screen.width / 2) {
                if (window.screenX + 102 - w - width < 0) {
                    w = 0;
                    h = h + maxHeight;
                    top = h + 1;
                    maxHeight = 0;
                    if (screen.height - h - height + getOffset(document.getElementById('usersList')).left - 155 < 0) {
                        h = 0;
                    }
                }
            }
            if (window.screenX + getOffset(document.getElementById('usersList')).left < screen.width / 2) {
                if (firstRun == 0) {
                    w = window.screenX + getOffset(document.getElementById('usersList')).left + 20;
                    firstRun = 1;
                }
                if (screen.width - w - width < 0) {
                    w = window.screenX + +getOffset(document.getElementById('usersList')).left + 20;
                    h = h + maxHeight;
                    top = h + 1;
                    maxHeight = 0;
                    if (screen.height - h - height < 0) {
                        h = 0;
                    }
                }
            }
            left = w + 1;
            tops = h + 1;
            w = w + width + 7;
            var file = './' + name + '.flv?action=play';
            var settings = 'width=' + width + ', height=' + height + ', left=' + left + ', top=' + tops + ', screenX=' + left + ', screenY=' + tops;
            wins.push(window.open(file, name, settings));
            exNames.push(name);
        }
        for (var i = 0; i < wins.length; ++i) {
            wins[i].focus();
        }
    }
    function update() {
        var xmlhttp;
        try {
            xmlhttp = new XMLHttpRequest();
        } catch (e) {
            var success = false;
            var objects = ["MSXML2.XMLHTTP.5.0", "MSXML2.XMLHTTP.4.0", "MSXML2.XMLHTTP.3.0", "MSXML2.XMLHTTP", "Microsoft.XMLHTTP"];
            for (var i = 0; i < objects.length && !success; i++) {
                try {
                    xmlhttp = new ActiveXObject(objects[i]);
                    success = true;
                } catch (e) { };
            }
            if (!success) throw new Error("AJAX is unavailabe");
        }
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4) {
                document.getElementById('usersList').innerHTML = xmlhttp.responseText;
            };
        }
        xmlhttp.open("get", "buttons.html", true);
        xmlhttp.send(null);
    }
    update();
    setInterval(update, 5000);
</script>
<div id="nifty">
<b class="rtop"><b class="r1"></b><b class="r2"></b><b class="r3"></b><b class="r4"></b></b>
<h1>Cloud Observer</h1> <p><b>Live video streaming</b></p>
<b class="rbottom"><b class="r4"></b><b class="r3"></b><b class="r2"></b><b class="r1"></b></b>
</div> <p/>
<div id="nifty">
<b class="rtop"><b class="r1"></b><b class="r2"></b><b class="r3"></b><b class="r4"></b></b>
<h1>Users online</h1> <p>You can watch user streams by clicking on buttons with their names.</p>
<hr> <ul id="usersList">
_ONLINE_USERS_</ul> <hr>
<p style="font-size: 8pt">This is a demo product. Number of broadcasters is limited to 6. <br/>Cloud Forever team 2010.</p>
<b class="rbottom"><b class="r4"></b><b class="r3"></b><b class="r2"></b><b class="r1"></b></b>
</div> </body> </html>